<!DOCTYPE html>
{% load static %}
<html lang="en">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    


<body class="aside-collapsed" style="background-color: rgb(235, 240, 240);">
    <div class="wrapper">
        <!-- top navbar-->
        <header class="topnavbar-wrapper">
            <!-- START Top Navbar-->
            <nav role="navigation" class="navbar topnavbar">
                <!-- START navbar header-->
                <div class="navbar-header">
                    <a href="#/" class="navbar-brand">
                        <div class="brand-logo">
                            <img src="{% static 'images/logo.jpg' %}" alt="App Logo" class="logo">
                        </div>
                    </a>
                </div>
                <!-- END navbar header-->
                <!-- START Nav wrapper-->
                <div class="nav-wrapper">
                    <!-- START Left navbar-->
                    <ul class="nav navbar-nav">
                        <li>
                            <!-- Button used to collapse the left sidebar. Only visible on tablet and desktops-->
                            <a href="#" data-trigger-resize="" data-toggle-state="aside-collapsed"
                                class="hidden-xs togglemeu">
                                <em class="icon-options-vertical"></em>
                            </a>
                            <!-- Button to show/hide the sidebar on mobile. Visible on mobile only.-->
                            <a href="#" data-toggle-state="aside-toggled" data-no-persist="true"
                                class="visible-xs sidebar-toggle togglemeu">
                                <em class="icon-options-vertical"></em>
                            </a>
                        </li>
                        <!-- START User avatar toggle-->
                        <li>
                            <h3 class="all-head">Add Job</h3>
                        </li>
                        <!-- END User avatar toggle-->
                        <!-- START lock screen-->

                        <!-- END lock screen-->
                    </ul>
                    <!-- END Left navbar-->
                    <!-- START Right Navbar-->
                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="settings.php">
                                <em class="fa fa-cog"></em>
                            </a>
                        </li>

                        <li>
                            <a href="#" data-toggle="modal" data-target="#myModal">
                                <em class="fa fa-sign-out"></em>
                            </a>
                        </li>
                        <!-- END Offsidebar menu-->
                    </ul>
                    <!-- END Right Navbar-->
                </div>

            </nav>
            <!-- END Top Navbar-->
        </header>
        <!-- sidebar-->
        <!-- header -->



        <div class="container-fluid">
            <div class="row">
                
                <div class=" col-12 py-5" style="background-color: white;">
                    <section>
                        <!-- Page content-->
                        <div class="content-wrapper">
                            <div class="container-fluid">
                                <!-- <div class="row"> -->
                                <div class="panel panel-default">
                                    <div class="panel-body">
                                        <form action="" method="post" enctype="multipart/form-data">
                                            {% csrf_token %}
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <label class="control-label">Job number</label>
                                                    <input required type="text" name="job_number" class="form-control"
                                                        placeholder="Job number">
                                                </div>
                                                <div class="col-md-6">
                                                    <label class="control-label">Customer</label>
                                                    <div class="input-group">
                                                        <select class="form-control select2-2 select2-hidden-accessible"
                                                            tabindex="-1" aria-hidden="true" name="customer">
                                                            {% for us in users %}
                                                            <option value="{{us.id}}">{{us.username}}</option>
                                                            {% endfor %}
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <label class="control-label">Aircraft</label>
                                                    <div class="input-group">
                                                        <select name="air_craft"
                                                            class="form-control select2-2 select2-hidden-accessible" tabindex="-1"
                                                            aria-hidden="true">
                                                            {% for air in air_craft %}
                                                            <option value="{{air.id}}">{{air.air_craft_name}}</option>
                                                            {% endfor %}
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <br>
                                            <div class="addpartnumber">
                                                <div class="row border p-2 mx-4 shadow mb-3" id="partsContainer">
                                                    <div class="col-md-3">
                                                        <label class="control-label">Part number</label>
                                                        <div class="input-group">
                                                            <select class="form-select partNumberSelect" name="part_number" aria-label="Default select example">
                                                                {% for p in parts %}
                                                                <option value="{{ p.id }}" data-description="{{ p.description }}">{{ p.number }}</option>
                                                                {% endfor %}
                                                            </select>
                                                            <button type="button" class="btn bg-secondary" data-bs-toggle="modal" data-bs-target="#part-number">
                                                                <i class="fa-solid fa-plus"></i>
                                                            </button>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <label class="control-label">Description</label>
                                                        <textarea class="form-control" name="description" rows="2" style="resize: vertical; min-height: 10px; min-width: 450px;" placeholder="Type.." maxlength="400"></textarea>
                                                    </div>
                                                    <div class="col-md-2">
                                                        <label class="control-label">Serial number</label>
                                                        <input type="text" name="serial_number" class="form-control" placeholder="Serial number">
                                                    </div>
                                                    <div class="col-md-1">
                                                        <label class="control-label">TSN</label>
                                                        <input type="text" name="tsn" class="form-control" placeholder="TSN">
                                                    </div>
                                                    <div class="col-md-1">
                                                        <label class="control-label">TSO</label>
                                                        <input type="text" name="tso" class="form-control" placeholder="TSO">
                                                    </div>
                                                    <div class="col-md-1">
                                                        <button type="button" class="btn addMore" style="margin-top: 25px; background-color: rgb(10, 145, 17); color: rgb(242, 243, 241);"><i class="fa fa-plus"></i></button>
                                                    </div>
                                                </div>
                                            </div>
                                            <br>
                                            <div class="row">
                                                <div class="col-md-4">
                                                    <label class="control-label">Work details</label>
                                                    <input type="text" name="work_details" class="form-control"
                                                        placeholder="Work details">
                                                </div>
                                                <div class="col-md-4">
                                                    <label class="control-label">P.O.NO</label>
                                                    <input type="text" name="po_number" class="form-control" placeholder="P.O.NO">
                                                </div>
                                                <div class="col-md-4">
                                                    <label class="control-label">Upload P.O</label>
                                                    <input type="file" name="po_image" style="background-color: #fff;"
                                                        class="form-control" placeholder="Choose File">
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <label class="control-label">Notes</label>
                                                    <textarea name="note" rows="3" class="form-control"
                                                        placeholder="Type.."></textarea>
                                                </div>
                                            </div>
                                            <hr>
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div class="float-end">
                                                        <button type="submit" class="btn btn-primary">Save & Create
                                                            workpack</button>
                                                    </div>
                                                </div>
                                            </div>
            
                                        </form>
                                    </div>
                                </div>
                                <!-- </div> -->
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </div>
        <!-- Page footer-->
        <footer class="footer">
            <span>&copy; <span id="demoyear"></span> - Australian heliponents powered by ishtechnologie</span>
        </footer>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="part-number" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <form action="{%url 'part-add'%}" method="post">
                    {% csrf_token %}
                    <div class="modal-header">
                        <h1 class="modal-title fs-5" id="exampleModalLabel">Part
                            Creation
                        </h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <input type="text" name="number" class="form-control mt-4" placeholder="Enter Paidnumber">
                        <input type="text" name="description" class="form-control mt-4" placeholder="Enter Description">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="Submit" class="btn btn-primary">Save
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe"
        crossorigin="anonymous"></script>



    <script>
    // Function to handle the change event of the part number select element
function handlePartNumberChange(event) {
  const selectedOption = event.target.options[event.target.selectedIndex];
  const descriptionInput = event.target.closest(".row").querySelector("textarea[name='description']");
  
  // Set the description value based on the selected option's data attribute
  descriptionInput.value = selectedOption.getAttribute("data-description");
}

// Attach change event listener to all existing part number select elements
const partNumberSelects = document.querySelectorAll(".partNumberSelect");
partNumberSelects.forEach((select) => {
  select.addEventListener("change", handlePartNumberChange);
});



    </script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $(document).ready(function() {
    // Add More button click event
    $('.addMore').click(function() {
      var clonedContainer = $('#partsContainer').clone(); // Clone the container
      clonedContainer.find('input, textarea').val(''); // Clear input values
      clonedContainer.find('.addMore').remove(); // Remove the Add More button from the cloned container
      clonedContainer.find('.partNumberSelect').removeClass('partNumberSelect').addClass('partNumberSelectNew'); // Update select class to differentiate from original select

      // Find the description textarea in the cloned container and remove its value
      clonedContainer.find('textarea[name="description"]').val('');

      $('#partsContainer').after(clonedContainer); // Append the cloned container to the parent container

      // Update the name attributes of cloned form fields using array notation
      clonedContainer.find('[name="part_number"]').attr('name', 'part_number');
      clonedContainer.find('[name="description"]').attr('name', 'description');
      clonedContainer.find('[name="serial_number"]').attr('name', 'serial_number');
      clonedContainer.find('[name="tsn"]').attr('name', 'tsn');
      clonedContainer.find('[name="tso"]').attr('name', 'tso');

      // Initialize select2 for the cloned part number select
      clonedContainer.find('.partNumberSelectNew').select2();
    });
  });
</script>



</body>

</html>